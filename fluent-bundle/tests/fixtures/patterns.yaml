suites:
  -
    name: Patterns
    suites:
      -
        name: Simple string value
        resources:
          -
            source: foo = Foo
        tests:
          -
            name: returns the value
            asserts:
              -
                id: foo
                value: Foo
      -
        name: Complex string value
        resources:
          -
            source: |-
              foo = Foo
              -bar = Bar
              ref-message = { foo }
              ref-term = { -bar }
              ref-missing-message = { missing }
              ref-missing-term = { -missing }
              ref-malformed = { malformed
            errors:
              -
                type: Parser
        tests:
          -
            name: resolves the reference to a message
            asserts:
              -
                id: ref-message
                value: Foo
          -
            name: resolves the reference to a term
            asserts:
              -
                id: ref-term
                value: Bar
          -
            name: returns the id if a message reference is missing
            asserts:
              -
                id: ref-missing-message
                value: "{missing}"
                errors:
                  -
                    type: Reference
                    desc: "Unknown message: missing"
          -
            name: returns the id if a term reference is missing
            asserts:
              -
                id: ref-missing-term
                value: "{-missing}"
                errors:
                  -
                    type: Reference
                    desc: "Unknown term: -missing"
      -
        name: Complex string referencing a message with null value
        resources:
          -
            source: |-
              foo =
                  .attr = Foo Attr
              bar = { foo } Bar
        tests:
          -
            name: returns the null value
            skip: true
            asserts:
              -
                id: foo
                value: Foo
          -
            name: formats the attribute
            asserts:
              -
                id: foo
                attribute: attr
                value: Foo Attr
          -
            name: formats ??? when the referenced message has no value and no default
            asserts:
              -
                id: bar
                # XXX: Difference from JS
                value: "{foo} Bar"
                errors:
                  -
                    type: Reference
                    desc: "Unknown message: foo"
